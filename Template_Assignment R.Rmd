---
title: "Investigating COVID- 19 poverty"
author: "Suhani Chomal 2869867, Yasmine Baghedoud 2841987, Aljazi Almaari 2863840, Asmae Nafid 2838731"
date: " r Sys.Date(24-06-2025)G "
output: pdf_document
---

# Seting-up our environment

```{r package_install, include=FALSE}
install.packages("tidyverse")
install.packages("yaml")
install.packages("rmarkdown")
```

```{r packages}
require(tidyverse)
require(rmarkdown)
require(yaml)
```

# Title Page

names: Suhani Chomal , Yasmine Baghedoud , Aljazi Almaari , Asmae Nafid 

tutorial group number: CPR02

tutorial lecturer's name: Chantal Schouwenaar

# Part 1 - Identify a Social Problem
The COVID-19 pandemic has had a catastrophic impact on poverty within the United States, leading to a reversal of decades of progress of Americans. According to U.S. Census Bureau (2021), the official poverty rate had increased by 1% during the COVID pandemic, between 2019 and 2020. Poverty can be recognized as a major social problem both within the United States and worldwide due to its effects on families and communities as basic necessity provisions are reduced, further increasing and perpetuating a cycle of poverty.  
Additionally, the Supplemental Poverty Measure (SPM) demonstrated a sharp increase in poverty in the years 2022 to 2023 from 12.4% to 12.9%, illustrating the fragility of many households during and after the pandemic as many people lost their jobs and were thus still recovering (U.S. Census Bureau, 2023). 

US Census Bureau. (2021, 2 november). Income, Poverty and Health Insurance Coverage in the United States: 2020. Census.gov. https://www.census.gov/newsroom/press-releases/2021/income-poverty-health-insurance-coverage.html
 US Census Bureau. (2023, 1 november). Poverty Measure That Includes Government Assistance Increased to 12.4% in 2022, When Pandemic Relief Ended. Census.gov. https://www.census.gov/library/stories/2023/09/supplemental-poverty-measure.html 

## 1.1 Describe the Social Problem
Understanding of how poverty changed before and after the pandemic is vital for Developing focused policy responses and efficiently distributing resources.  Policymakers can use it to determine which groups were most impacted and evaluate how COVID-19 will effect economic inequality in the long run.

this research aims to investigate the poverty rates in the United States pre and post COVID-19 between the years 2017 and 2022. The aim of this research is to provide new data post-COVID and provide an analysis on the differences in poverty rates pre and post COVID-19.

# Part 2 - Data Sourcing

## 2.1 Load in the data

The datasets:
	•	Median Income of Households by State Using Three-Year Moving Averages
	https://www.census.gov/data/tables/time-series/demo/income-poverty/historical-income-households.html 
	•	Percent of People in Poverty by State, 3-Year Averages: 2004 to 2023
	https://www.census.gov/data/tables/time-series/demo/income-poverty/historical-poverty-people.html

# Load the income dataset
library(readxl)
income_data_4_ <- read_excel("~/Documents/GitHub/income data (4).xlsx")

# Load the poverty dataset
library(readr)
dataset <- read_csv("~/Documents/GitHub/dataset.csv")


## 2.2 Provide a short summary of the dataset(s)

```{r}
head(income_data)
head(poverty_data)
```


In this case we see 28 variables, but we miss some information on what units they are in. We also don't know anything about the year/moment in which this data has been captured.

``` r
inline_code = TRUE
```

These are things that are usually included in the metadata of the dataset. For your project, you need to provide us with the information from your metadata that we need to understand your dataset of choice.

Dataset 1:
Title: U.S. State-Level Poverty Rates: 2017–2023
Source: U.S. Census Bureau – Percent of People in Poverty by State, 3-Year Averages: 2004 to 2023
This U.S. government source provides pre-COVID and COVID poverty data and annual statistics by state on poverty from 2017–2022. The numbers for poverty rates are presented as an overview for each of the 50 states which allow for comparisons over time and geography. The data is compiled using a mixture of national surveys and records.
 
Dataset 2:
Title: Median Household Income by State: 2017–2023
Source: U.S. Census Bureau – Median Income of Households by State Using Three-Year Moving Averages
The 2017 to 2023 report also provides annual data on median household income across states. This dataset is the main tool for getting insight into the economic situations surrounding the poverty rates, giving a picture of how average earnings have changed before and after the COVID-19 pandemic.
 
The datasets that we chose are quite suitable for this research project because they offer consistent, annual, state-level data on two key socioeconomic indicators: poverty and income. These indicators make it possible to carry out a meaningful analysis of how the economic situation changed due to the pandemic. The U.S. Census Bureau was chosen as the principal source because it has the highest reputation as the leader in population and economic data in the United States. Its datasets are methodologically robust and are widely used by researchers and policymakers. Besides, the shared format, structure, and coverage years of both datasets facilitate direct comparison and combined analysis of the two datasets.
As for the metadata, both datasets are stored in the Excel format and are depicted in a tabular form. A dataset for each year from 2017 to 2023, inclusive, for all U.S. states is presented here. The poverty dataset provides variables such as total population, number below poverty, poverty rate and margin of error. The income dataset comprises the median household income figures per state in the current U.S. dollars.
 
As for limitations, both datasets have their constraints. The data is only available at the state level, limiting any in-depth analysis by smaller regions such as counties or cities. Neither dataset includes demographic variables such as race, age, or gender, which reduces the ability to assess the differential impact of COVID-19 on specific groups. In addition, the income figures are not inflation-adjusted, which may slightly distort comparisons over time unless adjusted. Lastly, the datasets focus on income-based poverty only, without accounting for broader measures of deprivation such as access to services or cost-of-living disparities. 


## 2.3 Describe the type of variables included

Think of things like:

-   Do the variables contain health information or SES information?

-   Have they been measured by interviewing individuals or is the data coming from administrative sources?

*For the sake of this example, I will continue with the assignment...*

This report includes datasets that show how certain socioeconomic variables (SES) relate to household income and poverty rates over time in several US states. These factors are crucial for understanding the changes in the economy and poverty levels both before and after the COVID-19 pandemic. 
 
Poverty dataset contains state-specific percentages and three-year averages. These factors represent economic deprivation at the state level and are based on official administrative data sources produced by the United States Census Bureau, rather than individual-level interviews. As for the income dataset, it includes variables such median household income by state, which is provided as three-year moving averages. The dataset also comes from administrative sources, depicting total household financial stability which is a good predictor of socioeconomic positioning. 
 
The socioeconomic status (SES) of households depends heavily on these variables because they represent their financial situation even though they lack direct health data. Reliable administrative sources provide information which ensures consistent comparability between different states and time periods. Researchers can use these variables to analyze how COVID-19 affected poverty patterns throughout the United States based on socioeconomic factors.


# Part 3 - Quantifying

## 3.1 Data cleaning

Say we want to include only larger distances (above 2) in our dataset, we can filter for this.

```{r data_cleaning}
mean(dataset$percollege)
```

Please use a separate 'R block' of code for each type of cleaning. So, e.g. one for missing values, a new one for removing unnecessary variables etc.

## 3.2 Generate necessary variables

Variable 1

```{r gen_var1}

```

Variable 2

```{r gen_var2}

```

## 3.3 Visualize temporal variation

```{r}
  theme_minimal()

# Read the dataset
library(readr)
merged_data <- read_csv("new_data_set111/merged_data.csv")

##now we do the line plot for median income 
# Load required libraries
library(ggplot2)
library(dplyr)
library(readr)

##Filter for tehe US and the years 2019-2023
us_income_data <- merged_data %>%
  filter(State == "United States", year %in% 2019:2023)

# Median Income Line Plot
ggplot(us_income_data, aes(x = year, y = Median_Income)) +
  geom_line(color = "darkgreen", size = 1.2) +
  geom_point(color = "darkgreen", size = 2) +
  labs(title = "Median Income in the United States (2019–2023)",
       x = "Year",
       y = "Median Income (USD)") +
  scale_y_continuous(limits = c(72000, 84000), breaks = seq(72000, 84000, by = 1000)) +
  theme_minimal()
```

## 3.4 Visualize spatial variation

```{r visualise_map}

```

Here you provide a description of why the plot above is relevant to your specific social problem.

## 3.5 Visualize sub-population variation

What is the poverty rate by state?

```{r visualise_subpopulations}
dataset$inmetro <- dataset$inmetro %>% as.factor()
# Boxplot of poverty rate by state using the 'midwest' dataset
ggplot(dataset, aes(x = inmetro, y = percadultpoverty)) +
  geom_boxplot() +
  labs(
    title = "Distribution of Poverty Rates by Metropolitan status (Midwest counties)",
    x = "Metropolitan Area",
    y = "Poverty Rate of Adults (%)"
  ) +
  theme_minimal() +
  theme(
    legend.position = "right"
  )
```

Here you provide a description of why the plot above is relevant to your specific social problem.

## 3.6 Event analysis

Analyze the relationship between two variables.

```{r analysis}
###Line plot for COVID-19

# Load required libraries
library(ggplot2)
library(dplyr)
library(readr)

# Read the dataset
data <- read_csv("long_new_dataset.csv")

# Filter for United States data and years 2019-2023
us_data <- data %>%
  filter(State == "United States", year %in% 2019:2023) %>%
  mutate(poverty = as.numeric(`Percent in poverty`))

# Poverty Rate Line Plot
ggplot(us_data, aes(x = year, y = poverty)) +
  geom_line(color = "blue", size = 1.2) +
  geom_point(color = "blue", size = 2) +
  geom_vline(xintercept = 2020, linetype = "dashed", color = "red", size = 1) +
  annotate("text", x = 2020, y = 12, label = "COVID-19", color = "red", vjust = -0.5, fontface = "bold") +
  labs(title = "Average Poverty Rate in the United States (2019–2023)",
       x = "Year",
       y = "Poverty Rate (%)") +
  ylim(11, 12) +
  theme_minimal()
```

Here you provide a description of why the plot above is relevant to your specific social problem.

# Part 4 - Discussion

## 4.1 Discuss your findings

# Part 5 - Reproducibility

## 5.1 Github repository link

The link to our PUBLIC repository is here:

https://github.com/asmae-1/Poverty-in-the-US 

## 5.2 Reference list

Use APA referencing throughout your document.
